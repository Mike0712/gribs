# Laravel 5.3

## Установка 

```
composer create-progect laravel/laravel имя_папки 5.3.*
```

###Настройка роутов:

Файл /Routes/web.php

Простейший роут:

```php
Route::get('/', 'HelloController@index') // Первый аргумент - реквест. / значит корень сайта. Если реквест другой, то слэш писать не нужно.
										 // Второй аргумент - имя контроллера в папке контроллера @ метод контроллера
```

###Контроллеры

Создание контроллера:

```
php artisan make:controller PageController
```

Метод контроллера обязательно что-то возвращает:

```php
public function index()
{
	return 'Hello';
}
```
Обычно возвращает имя шаблона, который требуется подключить к данному роуту (методу конроллера).

```php
public function index()
{
	return view('hello');
}
```

Причём если вьюха вложена в какаю-то папку, то адрес шаблона указывается следующим образом view('folder.hello')

Для передачи чего либо из контроллера в шаблон в контроллере(методе) создаём какую либо переменную и регистрируем её имя для view в специальном
методе with, например во так:
```php
public function index()
{
	$hello = 'Hallo World';
	return view('hello')->with('hеllo', $hello);
}
```
В шаблон передасться переменная с именем, указаннов в качестве первого аргумента, со значением во втором аргументе.
Но чаще применяется вот такой синтаксис:
```php
public function index()
{
	$first = 'John';
	$last = 'Smith';
	return view('hello', compact('first', 'last'));
}
Тогда в шаблон передадуться переменные $first и $last
```

###Шаблоны (Вьюхи)

В laravel используется шаблонизатор blade. Все шаблоны обязательно именуются следующим образом:

имя_шаблона.blade.php, например: index.blade.php.

####Важная особенность - наследование шаблонов

Создадим базовый шаблон layout.blade.php. Поместим в него базовую html структуру.
В местах, в которых планируются какие либо изменения в шаблонах-наследниках необходимо проставить метки
@yield('имя_секции'), наприер @yield('content').

В шаблоне наследнике в первой строке необходимо указать наследуемый шалон extends('имя_шаблона')
Для вставки изменяемого контента пишем @section('content'), а в конце вставки пишем @stop.

Также в шаблонизаторе доступны такие конструкции как @if @else @endif. @unless (если), например @unless if ! - если не.
@foreach @endforeach и $foreelse - на случай если массив пустой, например можно поместить ответ - "Статей нет!".

###Работа с базой данных:

Нужные параметры задаются в файле .env в корне проекта. Дополнительные настройки в файле /config/database.php. По умолчанию константы файла .env 
имеют приоритет перед тем, что записано в /config/database.php, однако в том же /config/database.php этот приоритет можно легко поменять.

####Миграции:
Для корректной работы миграций желательно доустановить пакет Doctrine/DBAL:

```
composer require doctrine/dbal
```

Все файлы миграций хранятся в одном месте, путь: /database/migrations/

Создаётся миграция командой:

```
php artisan make:migration имя_миграции
```
или с автозаполнением
```
php artisan make:migration имя_миграции --create="articles"
```
В папке с миграциями появится соответствующий файл с заданным нами именем, в котором будет лежать класс под этим же именем. В классе будет 2 метода
up() и down().
В методе up как правило что то создаётся в БД, в методе же down наоборот что-то грохается. Может быть и обратная ситуация, когда миграция должна грохнуть
какую-то таблицу или колонку в таблице.
   
Итак в методе up() создаём таблицу 
```php
Schema::create('articles', function (Blueprint $table)
{
// Здесь создаём сущности (колонки таблицы)
}
```
Что прописываем в тело функции:
```php
$table->increments('id'); // айдиншик автоинкремент
$table->string('name');   // Строковый тип varchar(255)
$table->timestamps();	 // Временной тип	
```
Также можем указать доп параметры, значения по умолчанию, внешние ключи и др.

Например:
```php
$table->string('email')->unique()
```

Для применения миграции команда:
```
php artisan migrate
```
для отката:
```
php artisan migrate:rollback
```

Для добавления колонки:
```php
Schema::table('articles', function (Blueprint $table) {
            $table->text('excerpt');
        });
```
Для удаления:
```php
Schema::table('articles', function (Blueprint $table)
        {
            $table->dropColumn('excerpt');
        });
```

###Модели
####Eloquent(Active record)

Создание модели:
```
php artisan make:model Article
```
Или указать вложенность 
```
php artisan make:model Models\Article
```

